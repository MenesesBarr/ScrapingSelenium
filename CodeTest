import requests
import pandas as pd
from bs4 import BeautifulSoup
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.chrome.options import Options
from time import sleep

#lista de produtos
description = ['Smart TV LED 32" TCL HDR 32S6500 2 HDMI','Headset Gamer com Microfone JBL Quantum 100',
'Caixa de Som Bluetooth JBL Flip 5']
#lista de preços magalu
listPrice = []

options = Options()
# options.add_argument('--headless')
options.add_argument('window-size=1000,1000')

navegador = webdriver.Chrome(options=options)
navegador.get('https://www.magazineluiza.com.br/')

sleep(0.5)
#preciso de um for aqui com a lista das descr. dos produtos
#esperar que o html seja estático
for desc in description : 
    inputMagalu = navegador.find_element_by_css_selector('.field-input-search.ui-autocomplete-input')
    inputMagalu.send_keys(desc)

    sleep(1)

    searchProduct = navegador.find_element_by_class_name('icon-search').click()

    sleep(1)

    product = navegador.find_element_by_css_selector('.sc-gpAxqO.cEqyhT').click()

    sleep(1)
    page_content = navegador.page_source

    site = BeautifulSoup(page_content, 'html.parser')

    #print(site.prettify())

    price = site.find('span', attrs={'class': 'price-template__text'})
    
    listPrice.append([price.text]) 

#lista de preços para pandas
#print(listPrice)

#dataframe
dados = pd.DataFrame(listPrice, columns=['price'])

print(dados)